---
title: "EDA"
author: "Yuchen Huang"
date: "2023-11-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)

suicide <- read.csv("master.csv")
hdi <- read.csv("HDR21-22_Composite_indices_complete_time_series.csv")
```

## data cleaning

```{r}
##get only hdi from the data
HDI <- hdi |>
  select(country, starts_with("hdi_")) |>
  select(-hdi_rank_2021)

## remove NA
HDI <- HDI |>
  filter(is.na(hdi_1990)==F)

## remove hdi in the column names
colnames(HDI) <- gsub("hdi_", "", colnames(HDI)) 
HDI <- HDI |> select(-starts_with("f"), -starts_with("m"))

## make HDI use the same country names in suicide
HDI$country[HDI$country == "Korea (Republic of)"] <- "Republic of Korea"

## convert HDI into long format
HDI_long <- HDI |>
  pivot_longer(cols = -country, names_to = "year", values_to = "HDI")

## select suicide data after 1990
suicide <- suicide |>
  filter(year >= 1990)
HDI_long$year <- as.integer(HDI_long$year)

## combine HDI_long and suicide together
Suicide <- suicide |>
  left_join(HDI_long, by = c("country", "year")) |>
  mutate(HDI.for.year = HDI)
Suicide <- Suicide |>
  select(-HDI)

## check how many lines HDI is NA
Suicide_clean <- Suicide |>
  filter(is.na(HDI.for.year)==F)
#unique(Suicide_na$country)
paste0("There are ",length(unique(Suicide_clean$country))," countries in the data set")
```

```{r}
##Add Life Expectancy, MYSI, EYSI, GNI per capita
```

```{r}
## cleaning environment
rm(hdi, HDI, HDI_long, suicide, Suicide, Suicide_na)
```

## Countries

```{r}
Suicide_clean |> 
  subset(country %in% sample(Suicide_clean$country, 12)) |>
  ggplot() +
  aes(x = year, y = suicides.100k.pop, color = generation) +
  geom_point(size = .5) +
  facet_wrap(~country)
```

```{r}
Suicide_clean |> 
  subset(country %in% sample(Suicide_clean$country, 12)) |>
  ggplot() +
  aes(x = year, y = suicides.100k.pop, color = generation) +
  geom_point(size = .5) +
  facet_wrap(~country) +
  geom_smooth(method = "lm", color = "blue", size = .5)
```

## United State

```{r}
suicide_US <- suicide |>
  filter(country == "United States")
```

## Reference

[Human Development Reports](https://hdr.undp.org/data-center/documentation-and-downloads)
